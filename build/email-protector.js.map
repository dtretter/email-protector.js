{"version":3,"file":"email-protector.js","mappings":"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","sources":["webpack://email-protector.js/webpack/bootstrap","webpack://email-protector.js/webpack/runtime/define property getters","webpack://email-protector.js/webpack/runtime/hasOwnProperty shorthand","webpack://email-protector.js/webpack/runtime/make namespace object","webpack://email-protector.js/./src/tools.js","webpack://email-protector.js/./src/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const Tools = {\n  isString: (value) => typeof value === 'string' || value instanceof String,\n  isValidEmail: (str) => /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(String(str)),\n  regExpEscape: (str) => String(str).replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&'),\n  reverseString: (str) => String(str).split('').reverse().join(''),\n  getRandomString: (length = 8, charset = 'abcdefghijklmnopqrstuvwxyz') => Array.from({ length }, () => charset[Math.floor(Math.random() * charset.length)]).join(),\n  getRandomEmail: () => `${Tools.getRandomString(6)}@${Tools.getRandomString(10)}.${Tools.getRandomString(3)}`,\n  getRandomNumber: (min, max) => Math.floor(Math.random() * (max - min) + min),\n  getUniqID: () => `_${Date.now().toString(36) + Math.random().toString(36).substr(2)}`,\n};\n\nexport default Tools;\n","/* eslint-disable import/prefer-default-export */\nimport tools from './tools';\n\nconst Helper = {};  // Helper functions (defined later)\n\nexport const EmailProtector = {\n  defaultConfig: {\n    code: 47,\n    cssReverse: true,\n    hiddenSpan: true,\n    htmlComments: true,\n    linkPrefix: 'mailto:',\n  },\n  config: {},\n  params: {},\n\n  rot: (str, code = 13) => String(str)\n    .replace(/[a-z]/gi, (char) => {\n      const upperLimit = char <= 'Z' ? 90 : 122;\n      const rotedChar = char.charCodeAt(0) + (code % 26);\n      return String.fromCharCode((rotedChar <= upperLimit) ? rotedChar : rotedChar - 26);\n    }),\n  rot47: (str, code = 47) => {\n    const mycode = code - 14;\n    const s = [];\n    for (let i = 0; i < str.length; i += 1) {\n      const cc = str.charCodeAt(i);\n      if (cc >= 33 && cc <= 126) {\n        s[i] = String.fromCharCode(mycode + ((cc + 14) % 94));\n      } else {\n        s[i] = str.charAt(i);\n      }\n    }\n    return s.join('');\n  },\n\n  append: (parentID, params = {}, config = {}) => {\n    const paramsPrepared = Helper.prepareParams(params);\n    const configPrepared = Helper.prepareConfig(config);\n    window.addEventListener('load', () => {\n      const parentNode = document.getElementById(parentID);\n      if (!parentNode) {\n        throw new TypeError(`EmailProtector: element with ${parentID} ID not found`);\n      }\n      const linkNode = document.createElement('A');\n      linkNode.id = tools.getUniqID();\n      parentNode.appendChild(linkNode);\n      Helper.setupLink(linkNode.id, paramsPrepared, configPrepared);\n    });\n  },\n  write: (params = {}, config = {}) => {\n    const paramsPrepared = Helper.prepareParams(params);\n    const configPrepared = Helper.prepareConfig(config);\n    const uniqID = tools.getUniqID();\n    document.write(`<a id=\"${uniqID}\"></a>`);\n    Helper.setupLink(uniqID, paramsPrepared, configPrepared);\n  },\n  setGlobalParams: (params) => {\n    EmailProtector.params = {};  // _prepareParams() use this value, so we have to reset it first\n    EmailProtector.params = Helper.prepareParams(params);\n  },\n  setGlobalConfig: (config) => {\n    EmailProtector.config = {};  // _prepareConfig() use this value, so we have to reset it first\n    EmailProtector.config = Helper.prepareConfig(config);\n  },\n  resetParams: () => {\n    EmailProtector.params = {};\n  },\n  resetConfig: () => Object.assign(EmailProtector.config, EmailProtector.defaultConfig),\n  decode: (event, code) => {\n    const properEvent = event || window.event;\n    const target = properEvent.target || properEvent.srcElement;\n    if (!target.dataset.emailDecoded) {\n      target.href = EmailProtector.rot47(target.dataset.target, code);\n      // EmailProtector.rot47(target.href.substring(config.linkPrefix.length), code);\n      /* target.href = target.href.replace(\n          /\\b(\\w{6}:)?[\\w.]+(@|%40)\\w+(\\.\\w+)+\\b/gi,\n          (match) => EmailProtector.rot(match, code),\n        ); */\n      target.dataset.emailDecoded = true;\n    }\n    return true;\n  },\n};\n\nHelper.prepareParams = (params) => {\n  let preparedParams = params;\n  if (tools.isString(preparedParams)) {  // allow to pass an email address as a string only\n    preparedParams = { email: preparedParams };\n  }\n  if (!(preparedParams instanceof Object)) {\n    throw new TypeError('EmailProtector: params should be a string or an object');\n  }\n  preparedParams = { ...EmailProtector.params, ...preparedParams };\n  /* if (!tools.isValidEmail(preparedParams.email)) {\n    throw new TypeError(`EmailProtector: ${preparedParams.email} is not a valid email address`);\n  } */\n  return preparedParams;\n};\n\nHelper.prepareConfig = (config) => ({\n  ...EmailProtector.defaultConfig,\n  ...EmailProtector.config,\n  ...(config instanceof Object ? config : {}),\n});\n\nHelper.setupLink = (uniqID, params, config) => {\n  const code = config.code % 94;  // for code numbers greater than 94\n  const linkContainer = document.createDocumentFragment();\n  if (config.linkLabel) {\n    linkContainer.appendChild(document.createTextNode(config.linkLabel));\n  } else {\n    let linkText = EmailProtector.rot47(params.email, code);\n    console.log('decoded link text: ', linkText);\n    const randomEmail = tools.getRandomEmail();\n    const styleNode = document.createElement('STYLE');\n    if (config.cssReverse) {\n      linkText = tools.reverseString(linkText);\n      styleNode.appendChild(document.createTextNode(`\n        #${uniqID} {\n          unicode-bidi: bidi-override;\n          direction: rtl;\n        }\n      `));\n    }\n    const linkTextNode = document.createTextNode(linkText);\n    linkContainer.appendChild(linkTextNode);\n    if (config.hiddenSpan) {\n      const hiddenSpan = document.createElement('span');\n      hiddenSpan.appendChild(document.createTextNode(randomEmail));\n      // eslint-disable-next-line max-len\n      linkContainer.insertBefore(hiddenSpan, linkTextNode.splitText(tools.getRandomNumber(1, linkText.length)));\n      styleNode.appendChild(document.createTextNode(`\n        #${uniqID} span {\n          display: none;\n        }\n      `));\n    }\n    if (config.htmlComments) {\n      // Array.from to get static list => childNodes would change due to splitText()\n      Array.from(linkContainer.childNodes)\n        .forEach((node) => {\n          Helper.extendTextNodeWithComments(node, ['@', '.', '(', ')', '-', '0', '2', '6', '9,', ' ']);\n        });\n      linkContainer.insertBefore(document.createComment(` mailto:${randomEmail} `), linkContainer.firstChild);\n    }\n    if (styleNode.firstChild) document.head.appendChild(styleNode);\n  }\n\n  const mailtoEncrypted = EmailProtector.rot47(config.linkPrefix, 94 - code);\n  // console.log(mailtoEncrypted);\n  const emailLinkParams = Helper.prepareEmailLinkParams(params);\n  const linkNode = document.getElementById(uniqID);\n  linkNode.dataset.target = `${mailtoEncrypted}${params.email}${emailLinkParams}`;\n  // linkNode.href = `${config.linkPrefix}${params.email}${emailLinkParams}`;\n  linkNode.href = '#';\n  console.log(linkNode.href);\n  linkNode.appendChild(linkContainer);\n  linkNode.addEventListener('mousedown', (event) => EmailProtector.decode(event, code));\n};\n\nHelper.extendTextNodeWithComments = (node, searchStrings) => {\n  if (node.nodeType !== Node.TEXT_NODE) return false;\n  const searchStringsArray = [].concat(searchStrings);  // ensure it's an array\n  const searchRegExp = new RegExp(searchStringsArray.map((str) => tools.regExpEscape(str))\n    .join('|'), 'g');\n  const matches = node.textContent.match(searchRegExp) || [];  // [] => in case no match is found\n  let currentNode = node;\n  matches.forEach((str) => {\n    const preComment = document.createComment(` pre ${str} `);\n    const postComment = document.createComment(` post ${str} `);\n    const strPos = currentNode.textContent.indexOf(str);\n    if (strPos >= 0) {\n      const strSplit = currentNode.splitText(strPos);\n      currentNode.parentNode.insertBefore(preComment, strSplit);\n      const strSplitAfter = strSplit.splitText(str.length);\n      currentNode.parentNode.insertBefore(postComment, strSplitAfter);\n      currentNode = strSplitAfter;\n    }\n  });\n  return true;\n};\n\nHelper.prepareEmailLinkParams = (params) => {\n  const result = Object.entries(params)\n    .reduce((acc, [key, value]) => (key.match(/^cc|bcc|subject|body$/gi) ? `${acc}&${key}=${encodeURIComponent(value)}` : acc), '');\n  return (result.length > 0) ? `?${result.substring(1)}` : '';\n};\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","Tools","isString","String","isValidEmail","str","test","regExpEscape","replace","reverseString","split","reverse","join","getRandomString","length","charset","Array","from","Math","floor","random","getRandomEmail","getRandomNumber","min","max","getUniqID","Date","now","toString","substr","Helper","EmailProtector","defaultConfig","code","cssReverse","hiddenSpan","htmlComments","linkPrefix","config","params","rot","char","upperLimit","rotedChar","charCodeAt","fromCharCode","rot47","mycode","s","i","cc","charAt","append","parentID","paramsPrepared","prepareParams","configPrepared","prepareConfig","window","addEventListener","parentNode","document","getElementById","TypeError","linkNode","createElement","id","tools","appendChild","setupLink","write","uniqID","setGlobalParams","setGlobalConfig","resetParams","resetConfig","assign","decode","event","properEvent","target","srcElement","dataset","emailDecoded","href","preparedParams","email","linkContainer","createDocumentFragment","linkLabel","createTextNode","linkText","console","log","randomEmail","styleNode","linkTextNode","insertBefore","splitText","childNodes","forEach","node","extendTextNodeWithComments","createComment","firstChild","head","mailtoEncrypted","emailLinkParams","prepareEmailLinkParams","searchStrings","nodeType","Node","TEXT_NODE","searchStringsArray","concat","searchRegExp","RegExp","map","matches","textContent","match","currentNode","preComment","postComment","strPos","indexOf","strSplit","strSplitAfter","result","entries","reduce","acc","encodeURIComponent","substring"],"sourceRoot":""}